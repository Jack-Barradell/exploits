# CVE-2018-10933 - libssh Authentication Bypass
# https://nvd.nist.gov/vuln/detail/CVE-2018-10933


import getopt
import sys
import paramiko
import socket


DEFAULT_PORT = 22


def usage():
    print("CVE-2016-6210 -  User enumeration in Open SSHD version 7.2p2")
    print()
    print("Flags:")
    print("{} - Target host".format("\t-t --target".ljust(20," ")))
    print("{} - Port running ssh".format("\t-p --port".ljust(20," ")))
    print()


def main():
    try:
        opts,args = getopt.getopt(sys.argv[1:],"t:p:",["target","port"])
    except getopt.GetoptError as e:
        print(str(e))
        usage()
        sys.exit(1)
    target = None
    port = DEFAULT_PORT
    for o,a in opts:
        if o in ("-t","--target"):
            target = a
        elif o in ("-p","--port"):
            try:
                port = int(a)
            except ValueError:
                print("[!] Invalid port provided, must be an int")
                sys.exit(1)
        else:
            print("[!] Invalid option {} with value: {}".format(o,a))
            usage()
            sys.exit(1)




if __name__ == '__main__':
    main()